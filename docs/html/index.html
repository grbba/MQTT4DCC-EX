<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DCC-EX MQTT: DccMQTT Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dccex-stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Dccpplogov2.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DCC-EX MQTT
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">MQTT support for the DCC-EX command station for model railroading</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="class_dcc_m_q_t_t.html">DccMQTT</a> Documentation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="mainpage"></a> Documentation for the <a class="el" href="class_dcc_m_q_t_t.html">DccMQTT</a> support for the DCC-EX CommandStation</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Introduction</h1>
<p>All of the following is based on the DCC code from Asbelos which you can find in his <a href="https://github.com/Asbelos/CVReader" title="CVeader by Asbelos">GitHub repository</a> Currently the DCC-EX command station communicates mainly on a point to point basis either through a serial line or WiFi ( based on the ESP8266 ). DCC-EX allows for receiving JRMI formatted command strings such ass &lt;R 1 1 1&gt; which reads the value of the configuration variable #1 from the decoder over Serial and WiFi (Standard Ethernet is not supported yet for receiving JRMI commands but should be easy to add). WiThrottle/EngineDriver support has been added and can be used over WiFi but again is limited to the local network either directly or through the JRMI WiThrottle server if JRMI is installed on a computer on the local network with the CommandStation connected through a Serial line or over WiFi.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Rationale</h1>
<p>Why MQTT as a protocol for communicating with the DCC-EX base station?</p>
<p>The vision for DCC-EX being to render DCC accessible to everyone the most simple and easy way. Being based on cheap Arduino hardware brought up the idea to consider the DCC-EX command station as an IoT device with as easy setup as e.g. for home automation appliances. Some of the usability criterias are</p>
<ul>
<li>Minimal hardware configuration ( but that is part of the DCC-EX CommandStation work to remove e.g. the need for jumpers )</li>
<li>Mostly automatic software configuration</li>
<li>Minimal to no network setup. No mDNS / bonjour services specificities router configurations etc...</li>
</ul>
<p>Other criteria / ideas</p>
<ul>
<li>Get more devs doing frontend or any other work on top of it the most easy &amp; simple way thus enlarging the the installed base of DCC++EX</li>
<li>Enable the use of all UI Tooling available based on MQTT opening up more</li>
<li>Be able to make a more modern version of JRMI (potentially without any installation as a web service)</li>
</ul>
<p>Basically propose the same plug &amp; play user experience you get for most digitally enabled equipment you can buy today being software only or having a hardware piece of equipment.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Use case scenarios</h1>
<p>For Individuals</p>
<p>maybe less of interest an only if they would be ready to pay a little amount / month for the RaaS ( rail road as a service ) product as everything to manage the layout would be on the cloud except the commandstation and depending on the commandstation with ESP wifi support (Where we have to figure out hwo to do the WiFI setup without recompilation ...)</p>
<p>For Clubs managing multiple command stations with one inface and transparent switiching between all off them based on used identifable ressources. Today a loco is identified by its CV and you can not have more than one with thesame CV on the same layout. Taking one loco from one layout to another will yield possibly unwnated results.</p>
<p>When taking a unkown loco to a new layout automatic reassignment of adresses can take place e.g. lookng up the assigned identities to that layout with their adresses find a free one a assign it to the new loco if there is a conflict.</p>
<p>So to start of the loco would be placed on the programming track and on the user expirience side only some sor of register loco to layout would have to be done everything else is transparent no cv to be used anymore and i don't have to know anything about the adresses of the other locos.</p>
<p>Actually you could assign the loco to multiple layouts and just by putting the loco on the programming track and activate it may be sufficient ( we can even think about a fingerprinting system uniquley identifying the loco ? )</p>
<p>Manage multiple users on the same layout e.g. you want that a given user has only cpacity to control his/her own loco or a subset of locos/turnouts etc.. and the admins want minimal setup configuration to be done on this. In such a case we can imagine a topic per loco identity on the MQTT broker which then controls the acces rights based on the connected user. grant acces to a commandstation based on its uniqueID and on finer granularity grant acces to a loco assigned to the layout based on on it's identiy ( not the adress as they are transparent )</p>
<p>Going from club to club or better saying from layout to layout using the same setup gets transparent when used in the cloud where each user has his/her loco identities available. The admin of the layout then just has to assign the grants to a user if he isn't known yet</p>
<p>WiFI setup with smartphone ESP8266 slmart config </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
